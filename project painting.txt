--To fetch all the paintings that are not displayed in any museums
 
SELECT w.name AS painting_name
FROM work w
LEFT JOIN museum m ON w.museum_id = m.museum_id
WHERE m.museum_id IS NULL;

--To find museums without any paintings displayed

SELECT m.name AS museum_name
FROM museum m
LEFT JOIN work w ON m.museum_id = w.museum_id
WHERE w.work_id IS NULL;

--To find out how many paintings have an asking price greater than their regular price

SELECT COUNT(*) AS num_paintings_with_higher_price
FROM product_size
WHERE sale_price > regular_price;

--To find the canvas size that costs the most

SELECT size_id, MAX(sale_price) AS max_sale_price
FROM product_size
GROUP BY size_id;

--To delete duplicate records from the work

DELETE FROM work
WHERE ROWID NOT IN (
    SELECT MIN(ROWID)
    FROM work
    GROUP BY work_id;
);

--To identify museums that are open on both Sunday and Monday

SELECT m.name AS museum_name, m.city
FROM museum m
JOIN museum_hours sun ON m.museum_id = sun.museum_id
JOIN museum_hours mon ON m.museum_id = mon.museum_id
WHERE sun.day = 'Sunday' AND mon.day = 'Monday';

--To identify the artists whose paintings are displayed in multiple countries

SELECT
    a.artist_id,
    a.full_name AS artist_name,
    COUNT(DISTINCT m.country) AS num_countries_displayed
FROM
    artist a
JOIN
    work w ON a.artist_id = w.artist_id
JOIN
    museum m ON w.museum_id = m.museum_id
GROUP BY
    a.artist_id, a.full_name
HAVING
    COUNT(DISTINCT m.country) > 1;

--total sales and regular prices for all paintings

SELECT
    SUM(ps.sale_price) AS total_sales,
    SUM(ps.regular_price) AS total_regular_prices
FROM
    product_size ps;

--To find out which country has the 5th highest number of paintings

SELECT country, num_paintings
FROM (
    SELECT
        m.country,
        COUNT(w.work_id) AS num_paintings,
        RANK() OVER (ORDER BY COUNT(w.work_id) DESC) AS country_rank
    FROM
        museum m
    JOIN
        work w ON m.museum_id = w.museum_id
    GROUP BY
        m.country
)
WHERE country_rank = 5;


